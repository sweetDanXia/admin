{"remainingRequest":"D:\\zdx\\project\\admin\\node_modules\\babel-loader\\lib\\index.js!D:\\zdx\\project\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\zdx\\project\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\zdx\\project\\admin\\src\\views\\ArticleEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\zdx\\project\\admin\\src\\views\\ArticleEdit.vue","mtime":1615029938853},{"path":"D:\\zdx\\project\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\zdx\\project\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\zdx\\project\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\zdx\\project\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L3pkeC9wcm9qZWN0L2FkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBWdWVFZGl0b3IgfSBmcm9tICJ2dWUyLWVkaXRvciI7CmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgaWQ6IHt9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBWdWVFZGl0b3I6IFZ1ZUVkaXRvcgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1vZGVsOiB7CiAgICAgICAgdGl0bGU6ICIiLAogICAgICAgIGNhdGVnb3JpZXM6IFtdCiAgICAgIH0sCiAgICAgIGNhdGVnb3JpZXM6IFtdCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZmV0Y2hDYXRlZ29yaWVzKCk7CiAgICB0aGlzLmlkICYmIHRoaXMuZmV0Y2goKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZUltYWdlQWRkZWQ6IGZ1bmN0aW9uIGhhbmRsZUltYWdlQWRkZWQoZmlsZSwgRWRpdG9yLCBjdXJzb3JMb2NhdGlvbiwgcmVzZXRVcGxvYWRlcikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgZm9ybURhdGEsIHJlczsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOyAvLyDlsIZpbWFnZeWtl+auteaUueaIkGZpbGXvvIzlkozlhbbku5bkuIrkvKDlrZfmrrXkuIDmoLcKCiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImZpbGUiLCBmaWxlKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLiRodHRwLnBvc3QoIi91cGxvYWQiLCBmb3JtRGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBFZGl0b3IuaW5zZXJ0RW1iZWQoY3Vyc29yTG9jYXRpb24sICJpbWFnZSIsIHJlcy5kYXRhLnVybCk7CiAgICAgICAgICAgICAgICByZXNldFVwbG9hZGVyKCk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBmZXRjaDogZnVuY3Rpb24gZmV0Y2goKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHJlczsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi4kaHR0cC5nZXQoIi9yZXN0L2FydGljbGVzLyIuY29uY2F0KF90aGlzMi5pZCkpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzMi5tb2RlbCA9IHJlcy5kYXRhOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBmZXRjaENhdGVnb3JpZXM6IGZ1bmN0aW9uIGZldGNoQ2F0ZWdvcmllcygpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICB2YXIgcmVzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLiRodHRwLmdldCgiL3Jlc3QvY2F0ZWdvcmllcyIpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzMy5jYXRlZ29yaWVzID0gcmVzLmRhdGE7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHNhdmU6IGZ1bmN0aW9uIHNhdmUoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIHJlczsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCFfdGhpczQuaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0LiRodHRwLnB1dCgiL3Jlc3QvYXJ0aWNsZXMvIi5jb25jYXQoX3RoaXM0LmlkKSwgX3RoaXM0Lm1vZGVsKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDk7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNC4kaHR0cC5wb3N0KCIvcmVzdC9hcnRpY2xlcyIsIF90aGlzNC5tb2RlbCk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0NC5zZW50OwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBfdGhpczQuJHJvdXRlci5wdXNoKCIvYXJ0aWNsZXMvbGlzdCIpOwoKICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgcmVzLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0LiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIuS/neWtmOaIkOWKnyIKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["ArticleEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA,SAAA,SAAA,QAAA,aAAA;AACA,eAAA;AACA,EAAA,KAAA,EAAA;AACA,IAAA,EAAA,EAAA;AADA,GADA;AAIA,EAAA,UAAA,EAAA;AACA,IAAA,SAAA,EAAA;AADA,GAJA;AAOA,EAAA,IAPA,kBAOA;AACA,WAAA;AACA,MAAA,KAAA,EAAA;AACA,QAAA,KAAA,EAAA,EADA;AAEA,QAAA,UAAA,EAAA;AAFA,OADA;AAKA,MAAA,UAAA,EAAA;AALA,KAAA;AAOA,GAfA;AAgBA,EAAA,OAhBA,qBAgBA;AACA,SAAA,eAAA;AACA,SAAA,EAAA,IAAA,KAAA,KAAA,EAAA;AACA,GAnBA;AAoBA,EAAA,OAAA,EAAA;AACA,IAAA,gBADA,4BACA,IADA,EACA,MADA,EACA,cADA,EACA,aADA,EACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,QADA,GACA,IAAA,QAAA,EADA,EAEA;;AACA,gBAAA,QAAA,CAAA,MAAA,CAAA,MAAA,EAAA,IAAA;AAHA;AAAA,uBAIA,KAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,EAAA,QAAA,CAJA;;AAAA;AAIA,gBAAA,GAJA;AAKA,gBAAA,MAAA,CAAA,WAAA,CAAA,cAAA,EAAA,OAAA,EAAA,GAAA,CAAA,IAAA,CAAA,GAAA;AACA,gBAAA,aAAA;;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA,KARA;AASA,IAAA,KATA,mBASA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,MAAA,CAAA,KAAA,CAAA,GAAA,0BAAA,MAAA,CAAA,EAAA,EADA;;AAAA;AACA,gBAAA,GADA;AAEA,gBAAA,MAAA,CAAA,KAAA,GAAA,GAAA,CAAA,IAAA;;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA,KAZA;AAaA,IAAA,eAbA,6BAaA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,MAAA,CAAA,KAAA,CAAA,GAAA,oBADA;;AAAA;AACA,gBAAA,GADA;AAEA,gBAAA,MAAA,CAAA,UAAA,GAAA,GAAA,CAAA,IAAA;;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA,KAhBA;AAiBA,IAAA,IAjBA,kBAiBA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEA,MAAA,CAAA,EAFA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAGA,MAAA,CAAA,KAAA,CAAA,GAAA,0BAAA,MAAA,CAAA,EAAA,GAAA,MAAA,CAAA,KAAA,CAHA;;AAAA;AAGA,gBAAA,GAHA;AAAA;AAAA;;AAAA;AAAA;AAAA,uBAKA,MAAA,CAAA,KAAA,CAAA,IAAA,CAAA,gBAAA,EAAA,MAAA,CAAA,KAAA,CALA;;AAAA;AAKA,gBAAA,GALA;;AAAA;AAOA,gBAAA,MAAA,CAAA,OAAA,CAAA,IAAA,CAAA,gBAAA;;AACA,oBAAA,GAAA,IAAA,GAAA,CAAA,MAAA,IAAA,GAAA,EAAA;AACA,kBAAA,MAAA,CAAA,QAAA,CAAA;AACA,oBAAA,IAAA,EAAA,SADA;AAEA,oBAAA,OAAA,EAAA;AAFA,mBAAA;AAIA;;AAbA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcA;AA/BA;AApBA,CAAA","sourcesContent":["<template>\r\n  <div>\r\n    <h1>{{ id ? \"编辑\" : \"新建\" }}文章</h1>\r\n    <el-form label-width=\"120px\" @submit.native.prevent=\"save\">\r\n      <el-form-item label=\"所属分类\">\r\n        <el-select v-model=\"model.categories\" multiple>\r\n          <el-option\r\n            v-for=\"item in categories\"\r\n            :key=\"item._id\"\r\n            :label=\"item.name\"\r\n            :value=\"item._id\"\r\n          ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"标题\">\r\n        <el-input v-model=\"model.title\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"详情\">\r\n        <vue-editor\r\n          v-model=\"model.body\"\r\n          seCustomImageHandler\r\n          @image-added=\"handleImageAdded\"\r\n        ></vue-editor>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" native-type=\"submit\">保存</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { VueEditor } from \"vue2-editor\";\r\nexport default {\r\n  props: {\r\n    id: {},\r\n  },\r\n  components: {\r\n    VueEditor,\r\n  },\r\n  data() {\r\n    return {\r\n      model: {\r\n        title: \"\",\r\n        categories: [],\r\n      },\r\n      categories: [],\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchCategories();\r\n    this.id && this.fetch();\r\n  },\r\n  methods: {\r\n    async handleImageAdded(file, Editor, cursorLocation, resetUploader) {\r\n      var formData = new FormData();\r\n      // 将image字段改成file，和其他上传字段一样\r\n      formData.append(\"file\", file);\r\n      const res = await this.$http.post(\"/upload\", formData);\r\n      Editor.insertEmbed(cursorLocation, \"image\", res.data.url);\r\n      resetUploader();\r\n    },\r\n    async fetch() {\r\n      const res = await this.$http.get(`/rest/articles/${this.id}`);\r\n      this.model = res.data;\r\n    },\r\n    async fetchCategories() {\r\n      const res = await this.$http.get(`/rest/categories`);\r\n      this.categories = res.data;\r\n    },\r\n    async save() {\r\n      let res;\r\n      if (this.id) {\r\n        res = await this.$http.put(`/rest/articles/${this.id}`, this.model);\r\n      } else {\r\n        res = await this.$http.post(\"/rest/articles\", this.model);\r\n      }\r\n      this.$router.push(\"/articles/list\");\r\n      if (res && res.status == 200) {\r\n        this.$message({\r\n          type: \"success\",\r\n          message: \"保存成功\",\r\n        });\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n"],"sourceRoot":"src/views"}]}